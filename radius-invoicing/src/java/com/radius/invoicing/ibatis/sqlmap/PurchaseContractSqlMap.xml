<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="purchaseContractSqlMap">

  <typeAlias alias="purchaseContract" type="com.radius.invoicing.ibatis.model.PurchaseContract" />
  
  <sql id="purchaseContractFileds">
  	 contract_id id,purchase_order_id orderId,supplier_id supplierId,supplier_name supplierName,contract_file_id contractFile,
  	 effect_date effectDate,sign_time signTime,purchaser purchaser,link_man man,link_mobile mobile,link_tel tel,link_fax fax,
  	 ordered_date orderedDate,delivery_date deliveryDate,delivery_point deliveryPoint,contract_terms contractTerms,newest_print_time printTime,newest_print_acc printAcc,
  	 newest_print_record printRecord,print_times printTimes,memo memo,paymented_status paymentedStatus,validity_date validityDate,status status,audited_status auditedStatus,
  	 ledger_id ledgerId,operator operator,motify_date modifyDate,creater creater,createdate createDate,reviser reviser,revisedate reviseDate,verifier verifier,verifydate verifyDate
  </sql>
  
  <resultMap id="purchaseContract" class="purchaseContract">
    <result column="contract_id" jdbcType="char" javaType="java.lang.String" property="id" />
    <result column="purchase_order_id" jdbcType="char" javaType="java.lang.String" property="orderId" />
    <result column="supplier_id" jdbcType="char" javaType="java.lang.String" property="supplierId" />
    <result column="supplier_name" jdbcType="varchar" javaType="java.lang.String" property="supplierName" />
    <result column="contract_file_id" jdbcType="int" javaType="java.lang.Integer" property="contractFile" />
    <result column="effect_date" jdbcType="datetime" javaType="java.util.Date" property="effectDate" />
    <result column="sign_time" jdbcType="datetime" javaType="java.util.Date" property="signTime" />
    <result column="purchaser" jdbcType="char" javaType="java.lang.String" property="purchaser" />
    <result column="link_man" jdbcType="varchar" javaType="java.lang.String" property="man" />
    <result column="link_mobile" jdbcType="char" javaType="java.lang.String" property="mobile" />
    <result column="link_tel" jdbcType="char" javaType="java.lang.String" property="tel" />
    <result column="link_fax" jdbcType="char" javaType="java.lang.String" property="fax" />
    <result column="ordered_date" jdbcType="datetime" javaType="java.util.Date" property="orderedDate" />
    <result column="delivery_date" jdbcType="datetime" javaType="java.util.Date" property="deliveryDate" />
    <result column="delivery_point" jdbcType="varchar" javaType="java.lang.String" property="deliveryPoint" />
    <result column="contract_terms" jdbcType="text" javaType="java.lang.String" property="contractTerms" />
    <result column="newest_print_time" jdbcType="datetime" javaType="java.util.Date" property="printTime" />
    <result column="newest_print_acc" jdbcType="char" javaType="java.lang.String" property="printAcc" />
    <result column="newest_print_record" jdbcType="text" javaType="java.lang.String" property="printRecord" />
  	<result column="print_times" jdbcType="int" javaType="java.lang.Integer" property="printTimes" />
    <result column="memo" jdbcType="text" javaType="java.lang.String" property="memo" />
    <result column="paymented_status" jdbcType="char" javaType="java.lang.String" property="paymentedStatus" />
    <result column="validity_date" jdbcType="datetime" javaType="java.util.Date" property="validityDate" />
    <result column="status" jdbcType="char" javaType="java.lang.String" property="status" />
    <result column="audited_status" jdbcType="char" javaType="java.lang.String" property="auditedStatus" />
    
  	<result column="ledger_id" jdbcType="char" javaType="java.lang.String" property="ledgerId" />
    <result column="operator" jdbcType="char" javaType="java.lang.String" property="operator" />
    <result column="modify_date" jdbcType="datetime" javaType="java.util.Date" property="modifyDate" />
    <result column="creater" jdbcType="char" javaType="java.lang.String" property="creater" />
    <result column="createdate" jdbcType="datetime" javaType="java.util.Date" property="createDate" />
    <result column="reviser" jdbcType="char" javaType="java.lang.String" property="reviser" />
    <result column="revisedate" jdbcType="datetime" javaType="java.util.Date" property="reviseDate" />
    <result column="verifier" jdbcType="char" javaType="java.lang.String" property="verifier" />    
    <result column="verifydate" jdbcType="datetime" javaType="java.util.Date" property="verifyDate"/>
  </resultMap>
  
  <sql id="whereLike">
  	<dynamic prepend="where">
  		1=1  
  		<isNotNull prepend="and" property="id">contract_id=#id#</isNotNull>
  		<isNotNull prepend="and" property="orderId">purchase_order_id=#orderId#</isNotNull>
  		<isNotNull prepend="and" property="supplierId">supplier_id=#supplierId#</isNotNull>
		<isNotNull prepend="and" property="supplierName">supplier_name LIKE CONCAT('%',#supplierName#,'%')</isNotNull>
		<isNotNull prepend="and" property="contractFile">contract_file_id=#contractFile#</isNotNull>
		<isNotNull prepend="and" property="effectDate">effect_date=#effectDate#</isNotNull>
		<isNotNull prepend="and" property="signTime">sign_time=#signTime#</isNotNull>
		<isNotNull prepend="and" property="purchaser">purchaser=#purchaser#</isNotNull>
		<isNotNull prepend="and" property="man">link_man=#man#</isNotNull>
		<isNotNull prepend="and" property="mobile">link_mobile=#mobile#</isNotNull>
		<isNotNull prepend="and" property="tel">link_tel=#tel#</isNotNull>
		<isNotNull prepend="and" property="fax">link_fax=#fax#</isNotNull>
		<isNotNull prepend="and" property="orderedDate">ordered_date=#orderedDate#</isNotNull>
		<isNotNull prepend="and" property="deliveryDate">delivery_date=#deliveryDate#</isNotNull>
		<isNotNull prepend="and" property="deliveryPoint">delivery_point=#deliveryPoint#</isNotNull>
		<isNotNull prepend="and" property="contractTerms">contract_terms=#contractTerms#</isNotNull>
		<isNotNull prepend="and" property="printTime">newest_print_time=#printTime#</isNotNull>
		<isNotNull prepend="and" property="printAcc">newest_print_acc=#printAcc#</isNotNull>
		<isNotNull prepend="and" property="printRecord">newest_print_record=#printRecord#</isNotNull>
		<isNotNull prepend="and" property="printTimes">print_times=#printTimes#</isNotNull>
		<isNotNull prepend="and" property="paymentedStatus">paymented_status=#paymentedStatus#</isNotNull>
		<isNotNull prepend="and" property="validityDate">validity_date=#validityDate#</isNotNull>
 		<isNotNull prepend="and" property="memo">memo=#memo#</isNotNull> 
 		<isNotNull prepend="and" property="status">status=#status#</isNotNull> 
 		<isNotNull prepend="and" property="auditedStatus">audited_status=#auditedStatus#</isNotNull> 
 		<isNotNull prepend="and" property="ledgerId">ledger_id=#ledgerId#</isNotNull> 
  	</dynamic>
  </sql>
 
	 <select id="getPurchaseContractById" parameterClass="java.lang.String" resultMap="purchaseContract">
	 	SELECT <include refid="purchaseContractFileds"/>
	 	FROM RS_PURCHASE_CONTRACT
	 	WHERE contract_id =#id#
	 </select>
   
   	<insert id="insert" parameterClass="purchaseContract">
   		INSERT INTO RS_PURCHASE_CONTRACT (
   			contract_id,
	  		<isNotNull  property="orderId">purchase_order_id,</isNotNull>
	  		<isNotNull  property="supplierId">supplier_id,</isNotNull>
			<isNotNull  property="supplierName">supplier_name,</isNotNull>
			<isNotNull  property="contractFile">contract_file_id,</isNotNull>
			<isNotNull  property="effectDate">effect_date,</isNotNull>
			<isNotNull  property="signTime">sign_time,</isNotNull>
			<isNotNull  property="purchaser">purchaser,</isNotNull>
			<isNotNull  property="man">link_man,</isNotNull>
			<isNotNull  property="mobile">link_mobile,</isNotNull>
			<isNotNull  property="tel">link_tel,</isNotNull>
			<isNotNull  property="fax">link_fax,</isNotNull>
			<isNotNull  property="orderedDate">ordered_date,</isNotNull>
			<isNotNull  property="deliveryDate">delivery_date,</isNotNull>
			<isNotNull  property="deliveryPoint">delivery_point,</isNotNull>
			<isNotNull  property="contractTerms">contract_terms,</isNotNull>
			<isNotNull  property="printTime">newest_print_time,</isNotNull>
			<isNotNull  property="printAcc">newest_print_acc,</isNotNull>
			<isNotNull  property="printRecord">newest_print_record,</isNotNull>
			<isNotNull  property="printTimes">print_times,</isNotNull>
	 		<isNotNull  property="memo">memo,</isNotNull>
			<isNotNull  property="paymentedStatus">paymented_status,</isNotNull>
			<isNotNull  property="validityDate">validity_date,</isNotNull>
	 		<isNotNull  property="status">status,</isNotNull> 
	 		<isNotNull  property="auditedStatus">audited_status,</isNotNull> 
	 		<isNotNull  property="ledgerId">ledger_id,</isNotNull> 
	  	    creater,
	  	    createdate
   		)VALUES(
   			#id#,
	  		<isNotNull  property="orderId">#orderId#,</isNotNull>
	  		<isNotNull  property="supplierId">#supplierId#,</isNotNull>
			<isNotNull  property="supplierName">#supplierName#,</isNotNull>
			<isNotNull  property="contractFile">#contractFile#,</isNotNull>
			<isNotNull  property="effectDate">#effectDate#,</isNotNull>
			<isNotNull  property="signTime">#signTime#,</isNotNull>
			<isNotNull  property="purchaser">#purchaser#,</isNotNull>
			<isNotNull  property="man">#man#,</isNotNull>
			<isNotNull  property="mobile">#mobile#,</isNotNull>
			<isNotNull  property="tel">#tel#,</isNotNull>
			<isNotNull  property="fax">#fax#,</isNotNull>
			<isNotNull  property="orderedDate">#orderedDate#,</isNotNull>
			<isNotNull  property="deliveryDate">#deliveryDate#,</isNotNull>
			<isNotNull  property="deliveryPoint">#deliveryPoint#,</isNotNull>
			<isNotNull  property="contractTerms">#contractTerms#,</isNotNull>
			<isNotNull  property="printTime">#printTime#,</isNotNull>
			<isNotNull  property="printAcc">#printAcc#,</isNotNull>
			<isNotNull  property="printRecord">#printRecord#,</isNotNull>
			<isNotNull  property="printTimes">#printTimes#,</isNotNull>
	 		<isNotNull  property="memo">#memo#,</isNotNull>
			<isNotNull  property="paymentedStatus">#paymentedStatus#,</isNotNull>
			<isNotNull  property="validityDate">#validityDate#,</isNotNull>
	 		<isNotNull  property="stats">#stats#,</isNotNull> 
	 		<isNotNull  property="auditedStatus">#auditedStatus#,</isNotNull> 
	 		<isNotNull  property="ledgerId">#ledgerId#,</isNotNull> 
   			 creater,now()
   		)
   	</insert>
   
   	<update id="updatePurchaseContractById" parameterClass="purchaseContract">
   		UPDATE RS_PURCHASE_CONTRACT
   		<dynamic prepend="SET">
	  		<isNotNull prepend="," property="orderId">purchase_order_id=#orderId#</isNotNull>
	  		<isNotNull prepend="," property="supplierId">supplier_id=#supplierId#</isNotNull>
			<isNotNull prepend="," property="supplierName">supplier_name=#supplierName#</isNotNull>
			<isNotNull prepend="," property="contractFile">contract_file_id=#contractFile#</isNotNull>
			<isNotNull prepend="," property="effectDate">effect_date=#effectDate#</isNotNull>
			<isNotNull prepend="," property="signTime">sign_time=#signTime#</isNotNull>
			<isNotNull prepend="," property="purchaser">purchaser=#purchaser#</isNotNull>
			<isNotNull prepend="," property="man">link_man=#man#</isNotNull>
			<isNotNull prepend="," property="mobile">link_mobile=#mobile#</isNotNull>
			<isNotNull prepend="," property="tel">link_tel=#tel#</isNotNull>
			<isNotNull prepend="," property="fax">link_fax=#fax#</isNotNull>
			<isNotNull prepend="," property="orderedDate">ordered_date=#orderedDate#</isNotNull>
			<isNotNull prepend="," property="deliveryDate">delivery_date=#deliveryDate#</isNotNull>
			<isNotNull prepend="," property="deliveryPoint">delivery_point=#deliveryPoint#</isNotNull>
			<isNotNull prepend="," property="contractTerms">contract_terms=#contractTerms#</isNotNull>
			<isNotNull prepend="," property="printTime">newest_print_time=now()</isNotNull>
			<isNotNull prepend="," property="printAcc">newest_print_acc=#printAcc#</isNotNull>
			<isNotNull prepend="," property="printRecord">newest_print_record=#printRecord#</isNotNull>
			<isNotNull prepend="," property="printTimes">print_times=#printTimes#</isNotNull>
	 		<isNotNull prepend="," property="memo">memo=#memo#</isNotNull> 
			<isNotNull prepend="," property="paymentedStatus">paymented_status=#paymentedStatus#</isNotNull>
			<isNotNull prepend="," property="validityDate">validity_date=#validityDate#</isNotNull>
	 		<isNotNull prepend="," property="status">status=#status#</isNotNull> 
	 		<isNotNull prepend="," property="auditedStatus">audited_status=#auditedStatus#</isNotNull> 
	 		<isNotNull prepend="," property="ledgerId">ledger_id=#ledgerId#</isNotNull> 
	 		<isNotNull prepend="," property="operator">operator=#operator#,modify_date= now()</isNotNull>
  	 		<isNotNull  prepend="," property="reviser">reviser = #reviser#,revisedate = now() </isNotNull>
  			<isNotNull  prepend="," property="verifier">verifier = #verifier#,verifydate = now() </isNotNull>
   		</dynamic>
   		WHERE contract_id =#id# 
   	</update>
   	<select id="getPurchaseContractByCondition" parameterClass="purchaseContract" resultMap="purchaseContract">
   		SELECT <include refid="purchaseContractFileds"/>
   		FROM RS_PURCHASE_CONTRACT
   		<include refid="whereLike"/>
   	</select>
   	<!-- 分页查询语句 -->
   	<select id="getPurchaseContractSplitPageBySQL" remapResults="true" parameterClass="java.lang.String" resultMap="purchaseContract">
   		$splitPageSQL$
   	</select>
   	<!-- end -->
   	
   	<select id="getPurchaseContractSplitPageCountSQL" remapResults="true" parameterClass="java.lang.String" resultClass="java.lang.Integer">
   		$countSQL$
   	</select>
   	
   	<delete id="deletePurchaseContract" parameterClass="purchaseContract">
   		DELETE FROM RS_PURCHASE_CONTRACT
   		<include refid="whereLike"/>
   	</delete>
   	<delete id="deletePurchaseContractById" parameterClass="java.lang.String">
   		DELETE FROM RS_PURCHASE_CONTRACT
   		WHERE contract_id =#id# 
   	</delete>
   	
   	<update id="updatePurchaseContractStatusById" parameterClass="purchaseContract">
   		UPDATE RS_PURCHASE_CONTRACT
   		SET STATUS=#stats# <isNotNull property="reviser">,reviser = #reviser#,revisedate = now()</isNotNull>
   		WHERE contract_id =#id# 
   	</update>
</sqlMap>